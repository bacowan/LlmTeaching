This works, but isn't implemented with recursion.